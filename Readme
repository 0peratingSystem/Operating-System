# 8. A20 게이트를 활성화하여 1MB 이상 영역에 접근해보자

* 목표: A20 게이트의 의미와 역할에 대해 알아보고, 이를 활성화하여 1MB 이상의 메모리에 접근하게 변경, IA-32e 모드 커널 실행을 위해 메모리 크기를 확인하고 IA-32e 모드 커널 영역을 초기화

** A20 게이트란???
    A20 게이트에서 A20의 의미는 어드레스의 20번째 비트를 뜻하며, A20의 역할은 어드레스 20번째 비트를 활성화하거나 비활성화하여 XT PC의 어드레스 계산 방식과 호환성을 유지시킴 A20 게이트가 비활성화되면 어드레스 >라인의 20번째(1M의 위치)가 항상 0으로 고정되므로 선형 주소가 0x10FFEF가 되더라도 0xFFEF로 처리할 수 있음

IA-32e 모드 커널을 실행하기 위한 준비 작업으로 PC에 설치 된 메모리가 64MB 이상인지 검사하고 IA-32e 모드 커널이 위치할 영역을 모두 0으로 초기화하는 작업을 수행

reason? 0으로 초기화하는 이유
: 커널 이미지를 덮으면 될텐데 굳이 0으로 초기화하는 이유는, 이미지를 옮길 영역을 미리 0으로 초기화하지 않는다면 어떤 임의의 값이 들어있을 것, 이러한 상태에서 IA-32e 모드 커널이 실행되면 0으로 참조되어야 할 변수
들이 0이 아닌 값으로 설정되어, 루프를 빠져나오지 못한다든지, 잘못 된 조건문이 실행된다는지 하는 문제가 발생할 수 있음

결론> 이런 사태를 미연의 방지!!


부트 로더에 의해 커널 이미지가 메모리에 로딩되는 어드레스는 0x10000 이다.

만약 1MB 이하의 어드레스 중에서 비디오 메모리가 위치하는 0xA0000이하를 커널 공간으로 사용한다고 가정하면, 보호 모드커널과 IA-32e 모드 커널의 최대 크기는 (0xA0000 - 0x100000)이 되어 576KB정도

MINT64 OS는 커널이미지를 모두 0x10000 어드레스에 복사하되, 덩치가 큰 IA-32e 모드 커널은 2MB의 어드레스로 복사하여 2MB~6MB의 영역을 별도로 할당
--> 따라서 IA-32e 모드의 커널 영역은 모든 섹션을 포함하여 총 4MB의 크기!!!
